<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Supplemental Methods for LD filtering</title>
  <style type="text/css">code{white-space: pre;}</style>
  
  
</head>
<body>
<div id="header">
<h1 class="title">Supplemental Methods for LD filtering</h1>
</div>
<div id="TOC">
1
</div>
<!-- # Linkage measurements #

Plink version 1.9 [@Chang2015] was used to calculate pairwise linkage disequilibrium (LD) as $r$ for all SNP-pairs located on common supercontigs.
The `--allow-extra-chr` option was required to handle the number of supercontigs.
Unless stated otherwise, all subsequent analysis pertaining to LD used $r^2$.
 -->
<h1 id="ld-based-filtering-of-snp-pairs"><span class="header-section-number">1</span> 1: LD-based filtering of SNP-pairs</h1>
<p>The LD values of SNP-pairs were compared after binning SNP-pairs by base pair separation to control for unknown rates of recombination in <em>G. f. fuscipes</em>. Bin length was set at 50 bp with the lower bound inclusive and higher bound exclusive. In other words the bins were defined as <span class="math">[<em>i</em>, <em>i</em> + 49)</span> where <span class="math"><em>i</em> ∈ {1, 1(50), 2(50), 3(50)...<em>n</em>(50)}</span> and <span class="math"><em>n</em></span> is a positive integer.</p>
<p>To identify SNP-pairs for further investigation in an arbitrary set of binned SNP-pairs, we needed to assign probabilities to each SNP-pair in the bin. The distributions of binned SNP-pairs are bounded by 0 and 1 and do not appear to be Normal in shape. Additionally, in many cases, the data appear to exhibit peaks at both the lower and upper <span class="math"><em>r</em><sup>2</sup></span> range. This suggested that the data may be modeled well using the probability density function (PDF) of the Beta distribution:</p>
<p><br /><span class="math">$$f(x;\alpha,\beta) = \frac{x^{\alpha-1}(1-x)^{\beta-1}} {\mathrm{B}(\alpha,\beta)}$$</span><br /></p>
<p>with shape parameters <span class="math"><em>α</em></span> and <span class="math"><em>β</em></span> and where <span class="math"><em>x</em></span> represents an observed value generated by the distribution and <span class="math"><em>B</em>()</span> is the Beta function.</p>
<p>The Beta’s cumulative distribution function (CDF):</p>
<p><br /><span class="math">$$F(x;\alpha,\beta) = \frac{\mathrm{B}(x;\alpha,\beta)}{\mathrm{B}(\alpha,\beta)} $$</span><br /></p>
<p>can be used to describe the probability that a binned SNP-pair will be observed to have an <span class="math"><em>r</em><sup>2</sup> ≤ <em>x</em></span>. It follows that <span class="math">1 − <em>C</em><em>D</em><em>F</em></span> represents the probability of observing a more extreme value.</p>
<p>For each set of binned <span class="math"><em>r</em><sup>2</sup></span> values, the SNP-pairs deemed worthy of further investigation were defined as those where <span class="math">1 − <em>C</em><em>D</em><em>F</em> ≤ 0.01</span> after Benjamini-Hochberg (BH) correction for multiple testing <span class="citation">[1]</span>.</p>
<h2 id="scaling-of-binned-r2-distributions"><span class="header-section-number">1.1</span> 1.1: Scaling of binned <span class="math"><em>r</em><sup>2</sup></span> distributions</h2>
<p>The Beta distribution is bounded on the non-inclusive interval between 0 and 1. However, there are data in each bin that may have been assigned values of exactly 0 or 1. It is likely that these values are not truly 0 or 1 in the discrete binary sense that a coin-flip is <em>either</em> heads or tails. Therefore, the all data for each bin were scaled according to the following scheme</p>
<p><br /><span class="math">((<em>x</em><sub><em>i</em></sub> − 0.5) ⋅ <em>θ</em>) + 0.5</span><br /></p>
<p>in order to symmetrically shrink the distribution of values to fit within the open interval <span class="math">(0, 1)</span>. In the scheme above, let <span class="math"><em>x</em><sub><em>i</em></sub></span> stand for the <span class="math"><em>r</em><sup>2</sup></span> of each SNP-pair in an arbitrary bin set and <span class="math"><em>θ</em></span> stand for the scaling factor. The relevant results in this paper used <span class="math"><em>θ</em> = 0.999</span>.</p>
<h2 id="bayesian-parameter-estimation-using-the-binned-r2-distributions"><span class="header-section-number">1.2</span> 1.2: Bayesian parameter estimation using the binned <span class="math"><em>r</em><sup>2</sup></span> distributions</h2>
<p>In order to use the CDF of the Beta distribution to assign significances to each observed SNP-pair in a bin, it is necessary to learn the distribution parameters (<span class="math"><em>α</em></span> and <span class="math"><em>β</em></span>) for each bin given the specific data in each bin. For this we used custom python code that made heavy use of the following third-party data analysis modules: Pandas <span class="citation">[2]</span>, NumPy <span class="citation">[3]</span>, SciPy <span class="citation">[4]</span>, pyMC <span class="citation">[5]</span>, and StatsModels <span class="citation">[6]</span>.</p>
<p>We used pyMC to build the model of the Beta distribution and use it to exploit the bin-specific data to estimate the bin-specific values for the <span class="math"><em>α</em></span> and <span class="math"><em>β</em></span> parameters of the model [Figure fig_betamod]. The values of <span class="math"><em>α</em></span> and <span class="math"><em>β</em></span> were modeled with separate Uniform prior distributions from 0.01 to 10. This model topology was used to create pyMC “model” objects and initialized with the <span class="math"><em>r</em><sup>2</sup></span> data from each bin. The parameters of each Beta distribution were then estimated by <em>maximum a posteriori</em> (MAP) and used to calculate the <span class="math">1 − <em>C</em><em>D</em><em>F</em></span> for each SNP-pair in each bin <span class="citation">[3,4]</span>. The <span class="math">1 − <em>C</em><em>D</em><em>F</em></span> values were then BH corrected by bin and filtered with a threshold of <span class="math">(1 − <em>C</em><em>D</em><em>F</em>)<sub><em>B</em><em>H</em></sub> ≤ 0.01</span> using statsmodels <span class="citation">[1]</span>.</p>
<h1 id="code-availability"><span class="header-section-number">2</span> 2: Code availability</h1>
<p>The code used to run this and other parts of the analyses described in this manuscript may be found on github at the following project address.</p>
<p><a href="https://github.com/CacconeLabYale/gloria_soria_ddRAD_2015" class="uri">https://github.com/CacconeLabYale/gloria_soria_ddRAD_2015</a></p>
<div id="fig_betamod">
<div class="figure">
<img src="../figures/bin_MAP_model.png" alt="[fig_betamod]Network representation of the LD Beta model: Ovals represent modeled probability distributions. Circles represent learned parameters. Grey shading indicates use of observed data. " /><p class="caption"><strong>[fig_betamod]Network representation of the LD Beta model:</strong> Ovals represent modeled probability distributions. Circles represent learned parameters. Grey shading indicates use of observed data. </p>
</div>
</div>
<!-- ################################# -->
<p><!-- ################################# --></p>
<div class="references">
<h1>3: Bibliography</h1>
<p>1. Benjamini Y, Hochberg Y. Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing. Journal of the Royal Statistical Society Series B (Methodological). Wiley for the Royal Statistical Society; 1995;57: pp. 289–300. Available: <a href="http://www.jstor.org/stable/2346101" class="uri">http://www.jstor.org/stable/2346101</a></p>
<p>2. McKinney W. Data Structures for Statistical Computing in Python. In: Walt S van der, Millman J, editors. Proceedings of the 9th python in science conference. 2010. pp. 51–56. </p>
<p>3. <span>Van Der Walt</span> S, Colbert SC, Varoquaux G. The NumPy array: A structure for efficient numerical computation. Computing in Science and Engineering. 2011;13: 22–30. doi:<a href="http://dx.doi.org/10.1109/MCSE.2011.37">10.1109/MCSE.2011.37</a></p>
<p>4. Jones E, Oliphant T, Peterson P, Others. SciPy: Open source scientific tools for Python [Internet]. 2001. Available: <a href="http://www.scipy.org/" class="uri">http://www.scipy.org/</a></p>
<p>5. Patil A, Huard D, Fonnesbeck CJ. PyMC: Bayesian Stochastic Modelling in Python. Journal of statistical software. 2010;35: 1–81. Available: <a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3097064\&amp;tool=pmcentrez\&amp;rendertype=abstract" class="uri">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3097064\&amp;tool=pmcentrez\&amp;rendertype=abstract</a></p>
<p>6. Statsmodels-development-team. StatsModels: Statistics in Python (v0.6.1) [Internet]. Available: <a href="http://statsmodels.sourceforge.net/stable/" class="uri">http://statsmodels.sourceforge.net/stable/</a></p>
</div>
</body>
</html>
